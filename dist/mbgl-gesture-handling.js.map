{"version":3,"file":"mbgl-gesture-handling.js","sources":["../src/mbgl-gesture-handling.js"],"sourcesContent":["\"use strict\"\n\nclass GestureHandling {\n  constructor(options) {\n    this.fullscreen = false;\n    this.id = `mbgl-gesture-handling-help-container-${GestureHandling.count}`;\n    GestureHandling.count++;\n    this.timer = null;\n\n    this.settings = {\n      backgroundColor: 'rgba(0, 0, 0, 0.8)',\n      textColor: '#ffffff',\n      textMessage: 'Use alt + scroll to zoom the map.',\n      textMessageMobile: 'Use two fingers to move the map.',\n      timeout: 2000,\n      ...options\n    };\n\n    this.helpElement = document.querySelector(`#${this.id}`);\n\n    if (null === this.helpElement) {\n      this.helpElement = document.createElement('div');\n      this.helpElement.id = this.id;\n      this.helpElement.style.backgroundColor = this.settings.backgroundColor;\n      this.helpElement.style.position = 'absolute';\n      this.helpElement.style.display = 'none';\n      this.helpElement.style.zIndex = 9999;\n      this.helpElement.style.justifyContent = 'center';\n      this.helpElement.style.alignItems = 'center';\n\n      const textBox = document.createElement('div');\n      textBox.style.textAlign = 'center';\n      textBox.style.color = this.settings.textColor;\n      textBox.innerText = \"\";\n\n      this.helpElement.appendChild(textBox);\n      document.body.appendChild(this.helpElement);\n    }\n  }\n\n  showHelp(map, message) {\n    const rect = map.getContainer().getBoundingClientRect();\n    this.helpElement.style.top = `${rect.top + window.scrollY}px`;\n    this.helpElement.style.left = `${rect.left + window.scrollX}px`;\n    this.helpElement.style.width = `${rect.width}px`;\n    this.helpElement.style.height = `${rect.height}px`;\n    this.helpElement.style.display = 'flex';\n\n    this.helpElement.querySelector('div').innerText = message;\n  }\n\n  hideHelp() {\n    this.helpElement.style.display = 'none';\n  }\n\n  addTo(map) {\n    map.scrollZoom.disable();\n\n    this.helpElement.addEventListener('wheel', (event) => {\n      if (event.altKey || true === this.fullscreen) {\n        event.preventDefault()\n        this.hideHelp();\n      } else {\n        clearTimeout(this.timer);\n        this.timer = setTimeout(() => {\n          this.hideHelp();\n        }, this.settings.timeout);\n      }\n    });\n\n    map.getContainer().addEventListener('wheel', (event) => {\n      if (event.altKey || true === this.fullscreen) {\n        event.preventDefault()\n        if (! map.scrollZoom.isEnabled()) {\n          map.scrollZoom.enable();\n        }\n      } else {\n        map.scrollZoom.disable();\n        this.showHelp(map, this.settings.textMessage);\n        this.timer = setTimeout(() => {\n          this.hideHelp();\n        }, this.settings.timeout);\n      }\n    });\n\n    this.helpElement.addEventListener('touchstart', (event) => {\n      if (event.touches && (2 <= event.touches.length || true === this.fullscreen)) {\n        clearTimeout(this.timer);\n        this.hideHelp();\n        map.dragPan.enable();\n        event.preventDefault();\n      }\n    });\n\n    map.on('movestart', (event) => {\n      if (event.originalEvent && 'touches' in event.originalEvent\n              && 2 > event.originalEvent.touches.length && false === this.fullscreen) {\n        this.showHelp(map, this.settings.textMessageMobile);\n        map.dragPan.disable();\n        this.timer = setTimeout(() => {\n          map.dragPan.enable();\n          this.hideHelp();\n        }, this.settings.timeout);\n      }\n    });\n\n    document.addEventListener(\"fullscreenchange\", () => {\n      if ( document.fullscreenElement ) {\n        this.fullscreen = true;\n      } else {\n        this.fullscreen = false;\n      }\n    });\n  }\n}\n\nGestureHandling.count = 0 // static\n\nexport default GestureHandling;\n"],"names":["GestureHandling","constructor","options","fullscreen","id","count","timer","settings","Object","backgroundColor","helpElement","document","querySelector","this","createElement","style","position","display","zIndex","justifyContent","alignItems","textBox","textAlign","color","textColor","innerText","appendChild","body","showHelp","map","message","rect","getContainer","getBoundingClientRect","top","window","scrollY","left","scrollX","width","height","hideHelp","addTo","scrollZoom","disable","addEventListener","event","altKey","preventDefault","clearTimeout","setTimeout","timeout","isEnabled","enable","textMessage","touches","length","dragPan","on","originalEvent","textMessageMobile","fullscreenElement"],"mappings":"AAEA,IAAMA,EACJC,WAAYC,WACLC,YAAa,OACbC,GAAM,wCAAuCJ,EAAsB,MACxEA,EAAgBK,aACXC,MAAQ,UAERC,SAAWC,kBACdC,gBAAiB,+BACN,sBACE,sDACM,2CACV,aAINC,YAAcC,SAASC,kBAAkBC,KAAQ,IAElD,OAASA,KAAKH,YAAa,MACxBA,YAAcC,SAASG,cAAc,YACrCJ,YAAYN,GAAKS,KAAKT,QACtBM,YAAYK,MAAMN,gBAAkBI,KAAKN,SAASE,qBAClDC,YAAYK,MAAMC,SAAW,gBAC7BN,YAAYK,MAAME,QAAU,YAC5BP,YAAYK,MAAMG,OAAS,UAC3BR,YAAYK,MAAMI,eAAiB,cACnCT,YAAYK,MAAMK,WAAa,aAE9BC,EAAUV,SAASG,cAAc,OACvCO,EAAQN,MAAMO,UAAY,WAClBP,MAAMQ,MAAQV,KAAKN,SAASiB,UACpCH,EAAQI,UAAY,QAEff,YAAYgB,YAAYL,YACpBM,KAAKD,YAAYb,KAAKH,eAInCkB,YAAAA,kBAASC,EAAKC,OACNC,EAAOF,EAAIG,eAAeC,6BAC3BvB,YAAYK,MAAMmB,IAASH,EAAKG,IAAMC,OAAOC,kBAC7C1B,YAAYK,MAAMsB,KAAUN,EAAKM,KAAOF,OAAOG,kBAC/C5B,YAAYK,MAAMwB,MAAWR,kBAC7BrB,YAAYK,MAAMyB,OAAYT,mBAC9BrB,YAAYK,MAAME,QAAU,YAE5BP,YAAYE,cAAc,OAAOa,UAAYK,GAGpDW,YAAAA,yBACO/B,YAAYK,MAAME,QAAU,QAGnCyB,YAAAA,eAAMb,cACJA,EAAIc,WAAWC,eAEVlC,YAAYmC,iBAAiB,iBAAUC,GACtCA,EAAMC,SAAU,IAASlC,EAAKV,YAChC2C,EAAME,mBACDP,aAELQ,aAAapC,EAAKP,SACbA,MAAQ4C,wBACNT,YACJ5B,EAAKN,SAAS4C,cAIjBnB,eAAea,iBAAiB,iBAAUC,GACxCA,EAAMC,SAAU,IAASlC,EAAKV,YAChC2C,EAAME,iBACAnB,EAAIc,WAAWS,aACnBvB,EAAIc,WAAWU,WAGjBxB,EAAIc,WAAWC,YACVhB,SAASC,EAAKhB,EAAKN,SAAS+C,eAC5BhD,MAAQ4C,wBACNT,YACJ5B,EAAKN,SAAS4C,iBAIhBzC,YAAYmC,iBAAiB,sBAAeC,GAC3CA,EAAMS,UAAY,GAAKT,EAAMS,QAAQC,SAAU,IAAS3C,EAAKV,cAC/D8C,aAAapC,EAAKP,SACbmC,WACLZ,EAAI4B,QAAQJ,SACZP,EAAME,sBAINU,GAAG,qBAAcZ,GACfA,EAAMa,eAAiB,YAAab,EAAMa,eACnC,EAAIb,EAAMa,cAAcJ,QAAQC,SAAU,IAAU3C,EAAKV,eAC7DyB,SAASC,EAAKhB,EAAKN,SAASqD,mBACjC/B,EAAI4B,QAAQb,YACPtC,MAAQ4C,sBACXrB,EAAI4B,QAAQJ,WACPZ,YACJ5B,EAAKN,SAAS4C,YAIrBxC,SAASkC,iBAAiB,gCAEjB1C,aADFQ,SAASkD,qBASpB7D,EAAgBK,MAAQ"}